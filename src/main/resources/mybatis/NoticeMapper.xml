<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- @Mapper 인터페이스 사용시에는 네임스페이스에 반드시 @Mapper 를 명시한 인터페이스만 와야 한다 -->
<mapper namespace="com.ch.noticeapp.notice.repository.NoticeMapper">

    <insert id="insert" parameterType="Notice" useGeneratedKeys="true" keyProperty="noticeId" keyColumn="notice_id">
        insert into notice(title,writer,content) values(#{title}, #{writer}, #{content})
<!-- <selectKey>-->
<!--    select last_insert_id() as notice_id 위의 useGeneratedKeys 속성을 이용하면 last_insert_id() 를 사용할 필요 없다.-->
<!-- </selectKey>-->
    </insert>

<!-- 목록 가져오기. jap 에선 findAll 을 많이 쓴다. -->
    <select id="findAll" resultType="Notice">
        select notice_id, title, writer, content, regdate, hit from notice
        order by notice_id desc
    </select>

<!-- 데이터 한 건 가져오기 -->
    <select id="findById" parameterType="long" resultType="Notice">
        select notice_id, title, writer, content, regdate, hit from notice
        where notice_id=#{notice_id}
    </select>

<!-- 수정 -->
    <update id="update" parameterType="Notice">
        update notice set title=#{title}, writer=#{writer}, content=#{content}
        where notice_id=#{noticeId}
    </update>

<!-- 삭제 -->
    <delete id="deleteById" parameterType="Notice">
        delete from notice where notice_id=#{notice_id}
    </delete>

<!-- 조회수 증가 (상세보기 요청 처리 시) -->
    <update id="increaseHit" parameterType="long">
        update notice set hit = hit+1 where notice_id=#{notice_id}
    </update>

</mapper>